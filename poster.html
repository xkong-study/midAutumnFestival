<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="shortcut icon" type="image/x-icon" href="favicon.ico"/>
  <!-- 引入 Bootstrap 的 CSS 文件 -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/5.3.0/css/bootstrap.min.css"
        integrity="sha384-GLhl/gnuhmKJ+1UcbwzU6s/06vJ+eaK7TUVGKBfvlIO7b/w8NAb57ENyGJdD1+QKx" crossorigin="anonymous">
  <!-- 引入 Bootstrap Icons 的 CSS 文件 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
  <!--==================== UNICONS 图标====================-->
  <link
    rel="stylesheet"
    href="https://unicons.iconscout.com/release/v3.0.6/css/line.css"
  />
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <link rel="stylesheet" href="../midAutumn/assets/css/swiper-bundle.min.css"/>

  <!--==================== CSS ====================-->
  <link rel="stylesheet" href="../midAutumn/assets/css/styles.css"/>

  <title>Post Bar</title>
</head>
<body>
<!--==================== HEADER ====================-->
<header class="header scroll-header" id="header">
  <nav class="nav container">
    <a href="#" class="nav__logo">midAutumn</a>
    <i class="uil uil-edit"></i>
    <div class="nav__menu" id="nav-menu">
      <ul class="nav__list grid">
        <li class="nav__item">
          <div class="nav__link">
            <i class="uil uil-estate nav__icon"></i>
            <i class="uil uil-search"></i>
          </div>
        </li>
        <div class="topnav">
          <input type="text" placeholder="Search.." id="searchInput">
        </div>
      </ul>
      <i class="uil uil-times nav__close" id="nav-close"></i>
    </div>
    <div class="nav__btns">
      <i class="uil uil-moon change-theme" id="theme-button"></i>
      <div class="nav__toggle" id="nav-toggle">
        <i class="uil uil-apps"></i>
      </div>
    </div>
    <div class="nav__btns">
      <div class="dropdown">
        <img id="myImage" src="images/user.png" alt=""
             style="width:50px;height:50px;border-radius: 50%;margin-left: 30px;cursor:pointer"/>
        <div class="dropdown-content">
          <p id="username">Lisa</p>
          <button class="button1" onclick="cancel()">logout</button>
        </div>
      </div>
    </div>
  </nav>
</header>
<!--==================== MAIN ====================-->
<main class="main">
  <!--==================== HOME ====================-->
  <section class="home section" id="home">
    <div class="home__container container grid">
      <div class="home__scroll">
        <a href="#contact" class="home__scroll-button button--flex">
          <i class="uil uil-mouse-alt-2 home__scroll-mouse"></i>
          <span class="home__scroll-name"
          >Scroll down</span
          >
          <i class="uil uil-arrow-down home__scroll-arrow"></i>
        </a>
      </div>
      <div class="card_part">
        <button class="tablink" onclick="openPage('Home1', this, 'gray')" id="defaultOpen">For you</button>
        <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal"
                data-bs-whatever="midAutumn"
                style="width:70px;height:70px;background-color:gray;border-radius:50%;margin-left: 450px;border-color: gray;font-size: 30px">
          +
        </button>
      </div>
      <div id="Home1" class="tabcontent">
        <div class="home__content grid">
          <div class="home__img">
            <div id="cardContainer"></div>
          </div>
        </div>
      </div>
      <div id="News" class="tabcontent">
        <div class="home__content grid">
          <div class="home__img">
            <div id="cardContainer2"></div>
          </div>
        </div>
      </div>
  </section>


  <!--==================== CONTACT ME ====================-->
  <section class="contact section" id="contact">
    <h2 class="section__title">Contact me</h2>
    <span class="section__subtitle"
    >Get in touch</span
    >

    <div class="contact__container container grid">
      <div>
        <div class="contact__information">
          <i class="uil uil-phone-alt contact__icon"></i>

          <div>
            <h3 class="contact__title">Call me</h3>
            <span class="contact__subtitle"
            >166********</span
            >
          </div>
        </div>

        <div class="contact__information">
          <i class="uil uil-envelope contact__icon"></i>

          <div>
            <h3 class="contact__title">E-mail</h3>
            <span class="contatc__subtitle"
            >kong@###.ie</span
            >
          </div>
        </div>

        <div class="contact__information">
          <i class="uil uil-map-marker contact__icon"></i>

          <div>
            <h3 class="contact__title">Location</h3>
            <span class="contatc__subtitle"
            >HuNan , CHN</span
            >
          </div>
        </div>
      </div>
    </div>
  </section>
</main>

<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true"
     style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">New message to @mdo</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="uploadForm" enctype="multipart/form-data">
          <div class="mb-3">
            <label for="recipient-name" class="col-form-label">Title:</label>
            <input type="text" class="form-control" id="recipient-name">
          </div>
          <div class="mb-3">
            <label for="message-text" class="col-form-label">Content:</label>
            <textarea class="form-control" id="message-text"></textarea>
          </div>
          <div class="mb-3">

            <img ID="UserImg"/><br/>

            <input type="file" name="fileimage" id="fileimage" style="display: none"/>

            <br/>

            <input id="Btn_UserImg" type="button" value="choose pic"
                   style="background-color: gray;border: gray;border-radius: 25px;color: white;height: 50px;width:100px"/>

            <script>

              function Urlimg(e) {

                let url = null;

                if (window.URL != null) {

                  url = window.URL.createObjectURL(e);

                } else if (window.createObjectURL != null) {

                  url = window.createObjectURL(e);

                } else if (window.webkitURL != null) {

                  url = window.webkitURL.createObjectURL(e);

                }

                return url;

              };

              document.getElementById("Btn_UserImg").onclick = function () {

                document.getElementById("fileimage").click();

                document.getElementById("fileimage").onchange = function () {

                  var img = Urlimg(document.getElementById("fileimage").files[0]);

                  document.getElementById("UserImg").setAttribute("src", img);

                };

              };

            </script>

          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary" onclick="submitForm()">Post</button>
      </div>
    </div>
  </div>
</div>
<!--==================== SCROLL TOP ====================-->
<a href="#" class="scrollup" id="scroll-up">
  <i class="uil uil-arrow-up scrollup__icon"></i>
</a>
<!--==================== FOOTER ====================-->
<footer class="footer">
  <div class="footer__bg">
    <div class="footer__container container grid">
      <div>
        <h1 class="footer__title">MidAutumn</h1>
        <span class="footer__subtitle"
        >Chinese festival</span
        >
      </div>

      <ul class="footer__links">
        <li>
          <a href="#skills" class="footer__link">Introduction</a>
        </li>
        <li>
          <a href="#portfolio" class="footer__link">Post</a>
        </li>
        <li>
          <a href="#contact" class="footer__link">Contact</a>
        </li>
      </ul>

      <div class="footer__socials">
        <a href="https://gitee.com/asoutherncat/" target="_blank">
          <svg class="icon footer__social" aria-hidden="true">
            <use xlink:href="#icon-gitee"></use>
          </svg>
        </a>
        <a href="http://github.com" target="_blank">
          <svg class="icon footer__social" aria-hidden="true">
            <use xlink:href="#icon-github"></use>
          </svg>
        </a>
        <a href="https://t.bilibili.com/" target="_blank">
          <svg class="icon footer__social" aria-hidden="true">
            <use xlink:href="#icon-bilibili-line"></use>
          </svg>
        </a>
      </div>
    </div>

    <p class="footer__copy">
      &#169; midAutumn.Copy from
    </p>
  </div>
</footer>


<!--==================== SWIPER JS ====================-->
<script src="../midAutumn/assets/js/swiper-bundle.min.js"></script>

<!-- iconfont JS -->
<script src="../midAutumn/assets/js/iconfont.js"></script>
<!-- jquery -->
<script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<!--==================== MAIN JS ====================-->
<script src="../midAutumn/assets/js/main.js"></script>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.12.4/dist/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<script>
  let imgUrl = '';

  function fileChange(e) {
    // 选中的文件列表，如果设置了多选，length 可能会大于 1
    const fileList = e.target.files;
    if (fileList.length === 0) {
      this.imgUrl = '';
      return;
    }
    const file = fileList[0];
    // 使用 FileReader 读取文件对象
    const reader = new FileReader();
    // 读取完毕后获取结果
    reader.onload = event => {
      this.imgUrl = event.target.result;
    };
    // 把文件对象作为一个 dataURL 读入
    reader.readAsDataURL(file);
  }

  function submitForm() {
    var title = document.getElementById("recipient-name").value;
    var content = document.getElementById("message-text").value;
    var date = new Date();

// 获取年、月、日、小时、分钟和秒
    var year = date.getFullYear();
    var month = ('0' + (date.getMonth() + 1)).slice(-2);
    var day = ('0' + date.getDate()).slice(-2);
    var hour = ('0' + date.getHours()).slice(-2);
    var minute = ('0' + date.getMinutes()).slice(-2);
    var second = ('0' + date.getSeconds()).slice(-2);

// 格式化为所需的时间格式
    var formattedTime = year + '-' + month + '-' + day + ' ' + hour + ':' + minute + ':' + second;

    let formData = new FormData();

    formData.append('title', title)
    formData.append('content', content)
    formData.append('time', formattedTime)
    formData.append('author', localStorage.getItem('name'))
    formData.append('photo', document.getElementById("fileimage").files[0])


    console.log(formData)


    fetch('http://localhost:3050/tiezi/post', {
      method: 'POST',
      body: formData
    })
      .then(response => response.json())
      .then(data => {
        window.location.reload();
        console.log(data);
      })
      .catch(error => {
        // 处理错误
        console.error(error);
      });

  }

  document.querySelectorAll('[data-bs-toggle="tooltip"]')
    .forEach(tooltip => {
      new bootstrap.Tooltip(tooltip)
    })

  // --------
  // Popovers
  // --------
  // Instantiate all popovers in docs or StackBlitz
  document.querySelectorAll('[data-bs-toggle="popover"]')
    .forEach(popover => {
      new bootstrap.Popover(popover)
    })

  // -------------------------------
  // Toasts
  // -------------------------------
  // Used by 'Placement' example in docs or StackBlitz
  const toastPlacement = document.getElementById('toastPlacement')
  if (toastPlacement) {
    document.getElementById('selectToastPlacement').addEventListener('change', function () {
      if (!toastPlacement.dataset.originalClass) {
        toastPlacement.dataset.originalClass = toastPlacement.className
      }

      toastPlacement.className = `${toastPlacement.dataset.originalClass} ${this.value}`
    })
  }

  // Instantiate all toasts in docs pages only
  document.querySelectorAll('.bd-example .toast')
    .forEach(toastNode => {
      const toast = new bootstrap.Toast(toastNode, {
        autohide: false
      })

      toast.show()
    })

  // Instantiate all toasts in docs pages only
  // js-docs-start live-toast
  const toastTrigger = document.getElementById('liveToastBtn')
  const toastLiveExample = document.getElementById('liveToast')

  if (toastTrigger) {
    const toastBootstrap = bootstrap.Toast.getOrCreateInstance(toastLiveExample)
    toastTrigger.addEventListener('click', () => {
      toastBootstrap.show()
    })
  }

  const alertPlaceholder = document.getElementById('liveAlertPlaceholder')
  const appendAlert = (message, type) => {
    const wrapper = document.createElement('div')
    wrapper.innerHTML = [
      `<div class="alert alert-${type} alert-dismissible" role="alert">`,
      `   <div>${message}</div>`,
      '   <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>',
      '</div>'
    ].join('')

    alertPlaceholder.append(wrapper)
  }

  const alertTrigger = document.getElementById('liveAlertBtn')
  if (alertTrigger) {
    alertTrigger.addEventListener('click', () => {
      appendAlert('Nice, you triggered this alert message!', 'success')
    })
  }
  // js-docs-end live-alert

  // --------
  // Carousels
  // --------
  // Instantiate all non-autoplaying carousels in docs or StackBlitz
  document.querySelectorAll('.carousel:not([data-bs-ride="carousel"])')
    .forEach(carousel => {
      bootstrap.Carousel.getOrCreateInstance(carousel)
    })

  // -------------------------------
  // Checks & Radios
  // -------------------------------
  // Indeterminate checkbox example in docs and StackBlitz
  document.querySelectorAll('.bd-example-indeterminate [type="checkbox"]')
    .forEach(checkbox => {
      if (checkbox.id.includes('Indeterminate')) {
        checkbox.indeterminate = true
      }
    })

  // -------------------------------
  // Links
  // -------------------------------
  // Disable empty links in docs examples only
  document.querySelectorAll('.bd-content [href="#"]')
    .forEach(link => {
      link.addEventListener('click', event => {
        event.preventDefault()
      })
    })


  let img = localStorage.getItem('img')
  let myImage = document.getElementById("myImage");
  myImage.src = img;
  let usernameElement = document.getElementById("username");
  usernameElement.textContent = localStorage.getItem('name')

  function cancel() {
    let myImage = document.getElementById("myImage");
    myImage.src = 'images/img_3.png'
    let usernameElement = document.getElementById("username");
    usernameElement.textContent = 'unknown'
    localStorage.setItem('name', 'unknown')
    localStorage.setItem('img', 'images/img_3.png')
  }

  const exampleModal = document.getElementById('exampleModal')
  if (exampleModal) {
    exampleModal.addEventListener('show.bs.modal', event => {
      // Button that triggered the modal
      const button = event.relatedTarget
      // Extract info from data-bs-* attributes
      const recipient = button.getAttribute('data-bs-whatever')
      // If necessary, you could initiate an Ajax request here
      // and then do the updating in a callback.

      // Update the modal's content.
      const modalTitle = exampleModal.querySelector('.modal-title')
      const modalBodyInput = exampleModal.querySelector('.modal-body input')

      modalTitle.textContent = `New poster`
      modalBodyInput.value = recipient
    })
  }


  const myOffcanvas = document.querySelectorAll('.bd-example-offcanvas .offcanvas')
  if (myOffcanvas) {
    myOffcanvas.forEach(offcanvas => {
      offcanvas.addEventListener('show.bs.offcanvas', event => {
        event.preventDefault()
      }, false)
    })
  }

  let count = 1

  function openForm() {
    count++;
    if (count % 2 == 1) {
      document.getElementById("myForm").style.display = "block";
    } else {
      document.getElementById("myForm").style.display = "none";
    }
  }

  let params = ''

  function follow(params) {
    console.log(params)

  }
  function deleted(params){
      console.log(params)
    $.ajax({
      type: "GET",
      url: "http://localhost:3050/tiezi/delete", // 替换为实际的后端接口 URL
      data: {"post_id":Number(params)}, // 发送的数据对象
      success: function (response) {
        console.log(response)
      }
      })
    window.location.reload()
  }

  var searchInput = document.getElementById("searchInput");
  searchInput.focus();


  let counted = 0

  if (counted == 0) {
    console.log(counted)
    $.ajax({
      type: "GET",
      url: "http://localhost:3050/tiezi/getall", // 替换为实际的后端接口 URL
      success: function (response) {
        console.log(response);
        console.log(response.data);
        let info = response.data
        let usernameElement = document.getElementById("username");
        usernameElement.textContent = localStorage.getItem('name')
        for (let i = 0; i < info.length; i++) {
            const card = document.createElement('div');
            card.className = 'card';
            const name = info[i].author
          var name1 = localStorage.getItem('name');
          var icon = document.createElement('div');
          if (name1 === 'abc') {
            console.log(name1)
            icon.className = 'icon';
            icon.innerHTML = `<i class="uil uil-scroll-h" style="cursor:pointer;position:relative" onclick="deleted('${info[i].post_id}')"></i>`;
          }
          else{
            icon.innerHTML='<div/>'
          }
            let formData2 = {
              "post_id": info[i].post_id
            }

            fetch('http://localhost:3050/tiezi/get_images', {
              method: 'Post',
              headers: {
                'Content-Type': 'application/json;charset=UTF-8' // 设置请求头的 Content-Type 字段
              },
              body: JSON.stringify(formData2)
            })
              .then(response => response.blob())
              .then(blob => {
                console.log(blob)
                var imageURL = URL.createObjectURL(blob); // 创建 Blob 对象的 URL
                console.log(imageURL)
                const count = i + 1
                var imagePreview = document.getElementById('imagePreview' + count);
                imagePreview.src = imageURL; // 将 Blob 对象的 URL 设置为图片的 src 属性值
              })
              .catch(error => console.error(error));

            const comments = document.createElement('div');
            $.ajax({
              type: "GET",
              url: "http://localhost:3050/comment/get", // 替换为实际的后端接口 URL
              data: formData2, // 发送的数据对象
              success: function (response) {
                console.log(response.data);
                var responseData = {'author': '', 'content': ''};
                for (var item = 0; item < response.data.length; item++) {
                  responseData.author = response.data[item].author
                  responseData.content = response.data[item].content
                  var authorHtml = `<div style="display: flex; flex-direction: row; margin-left: 1.1rem; font-size: 1rem; color: #000000; margin-top: -5px;">
                    <p style="margin-left: 1.1rem; font-size: 1rem; color: #000000; margin-top: -5px;">${responseData.author}</p>
                    <p style="margin-left: 1.1rem; font-size: 1rem; color: #000000; margin-top: -5px;">${responseData.content}</p>
                    </div>`;
                  // 将生成的 HTML 内容添加到 comments 元素中
                  comments.innerHTML += authorHtml;
                }
              }
            })
            card.innerHTML = `
      <div class="card_part">
        <img src="./images/img_1.png" alt="Avatar" style="width:30px;border-radius: 50%;height:30px"/>
        <p style="margin-left: 1rem;font-size:1rem;font-color:#000000">${info[i].author}</p>
      </div>
      <div class="card_post">
        <div style="width: 70%;margin-left: 1rem">
          <h4 class="card_title">${info[i].title}</h4>
          <p class="card_description" style="font-size:1rem;width:25rem">
            ${info[i].content}
          </p>
        </div>
        <div><img id="imagePreview${i + 1}" src="#" alt="Image Preview" style="margin-left: -30px"></div>
      </div>
      <div class="card_part">
        <p class="card_info">${info[i].time.slice(0, 10)} write · Selected for you</p>
        <i class="uil uil-bookmark" style="text-indent: 3.5rem;margin-top: .2rem;cursor:pointer" onclick="follow('${name}')"></i>
        <i class="uil uil-comment-alt-message" style="text-indent: 1rem;margin-top: .2rem;cursor: pointer " onclick="openForm()"></i>
      </div>
        <div style="display:flex">
        <img src=${localStorage.getItem('img')} alt="Avatar" style="width:40px;border-radius: 50%;height:40px;margin-left: 10px;margin-top: 5px"/>
        <div class="chat-popup" id="myForm">
          <textarea id="myTextarea${i}" placeholder="Type message.." name="msg" required style="border-color: #4b4b4b;text-indent: 2em;border-radius:25px;width:300px;white-space: pre-line;margin-top: 2px"></textarea>
          <i class="uil uil-navigator" style="width:3rem;height:3rem;position:relative; top:-18px;cursor:pointer" id="myButton" onclick="getMessage(${i},'${info[i].post_id}')"></i>
        </div>
        </div>

        <div class="chat-popup">Comments:</div>
        <div class="card_part">
        <div>
        </div>
        </div>
    `;    card.appendChild(icon)
          card.appendChild(comments);
          cardContainer.appendChild(card);
        }
      },
      error: function (error) {
        // 请求失败后的处理逻辑
        console.log(error); // 可以在控制台打印错误信息
      }
    });
  }

  function getMessage(params1,params2) {
    console.log(params1,params2)
    const number = params1
    let textarea = document.getElementById('myTextarea'+number);
    let message = textarea.value;
    console.log(message)
    var date = new Date();

    var year = date.getFullYear();
    var month = ('0' + (date.getMonth() + 1)).slice(-2);
    var day = ('0' + date.getDate()).slice(-2);
    var hour = ('0' + date.getHours()).slice(-2);
    var minute = ('0' + date.getMinutes()).slice(-2);
    var second = ('0' + date.getSeconds()).slice(-2);

    var formattedTime = year + '-' + month + '-' + day + ' ' + hour + ':' + minute + ':' + second;
    console.log(localStorage.getItem('name'))
    let formData = {
      author: localStorage.getItem('name'),
      content: message,
      time: formattedTime,
      post_id: Number(params2)
    };

    $.ajax({
      type: "GET",
      url: "http://localhost:3050/comment/post", // 替换为实际的后端接口 URL
      data: formData, // 发送的数据对象
      success: function (response) {
        console.log(response);
        window.location.reload()
      },
      error: function (error) {
        // 请求失败后的处理逻辑
        console.log(error); // 可以在控制台打印错误信息
      }
    });
    alert("content: " + message);
  }


  searchInput.addEventListener("input", function () {
    cardContainer.innerHTML = '';
    var inputValue = searchInput.value;
    let formData = {
      title: inputValue || null
    }
    counted++
    console.log(counted)
    $.ajax({
      type: "GET",
      url: "http://localhost:3050/tiezi/search", // 替换为实际的后端接口 URL
      data: formData, // 发送的数据对象
      success: function (response) {
        console.log(response);
        console.log(response.data);
        let info = response.data
        let usernameElement = document.getElementById("username");
        usernameElement.textContent = localStorage.getItem('name')
        for (let i = 0; i < info.length; i++) {
          const card = document.createElement('div');
          card.className = 'card';
          const name = info[i].author
          var name1 = localStorage.getItem('name');
          var icon = document.createElement('div');
          if (name1 === 'abc') {
            console.log(name1)
            icon.className = 'icon';
            icon.innerHTML = `<i class="uil uil-scroll-h" style="cursor:pointer" onclick="deleted('${info[i].post_id}')"></i>`;
          }
          else{
            icon.innerHTML='<div/>'
          }
          let formData2 = {
            "post_id": info[i].post_id,
          }

          fetch('http://localhost:3050/tiezi/get_images', {
            method: 'Post',
            headers: {
              'Content-Type': 'application/json;charset=UTF-8' // 设置请求头的 Content-Type 字段
            },
            body: JSON.stringify(formData2)
          })
            .then(response => response.blob())
            .then(blob => {
              console.log(blob)
              var imageURL = URL.createObjectURL(blob); // 创建 Blob 对象的 URL
              console.log(imageURL)
              const count = i + 1
              var imagePreview = document.getElementById('imagePreview' + count);
              imagePreview.src = imageURL; // 将 Blob 对象的 URL 设置为图片的 src 属性值
            })
            .catch(error => console.error(error));

          const comments = document.createElement('div');

          $.ajax({
            type: "GET",
            url: "http://localhost:3050/comment/get", // 替换为实际的后端接口 URL
            data: formData2, // 发送的数据对象
            success: function (response) {
              console.log(response.data);
              var responseData = {'author':'','content':''};
              for (var item = 0; item < response.data.length; item++) {
                responseData.author = response.data[item].author
                responseData.content = response.data[item].content
                var authorHtml = `<div style="display: flex; flex-direction: row; margin-left: 1.1rem; font-size: 1rem; color: #000000; margin-top: -5px;">
                    <p style="margin-left: 1.1rem; font-size: 1rem; color: #000000; margin-top: -5px;">${responseData.author}</p>
                    <p style="margin-left: 1.1rem; font-size: 1rem; color: #000000; margin-top: -5px;">${responseData.content}</p>
                    </div>`;
                // 将生成的 HTML 内容添加到 comments 元素中
                comments.innerHTML += authorHtml;
              }
            }
          })
          card.innerHTML = `
      <div class="card_part">
        <img src="./images/img_1.png" alt="Avatar" style="width:30px;border-radius: 50%;height:30px"/>
        <p style="margin-left: 1rem;font-size:1rem;font-color:#000000">${info[i].author}</p>
      </div>
      <div class="card_post">
        <div style="width: 70%;margin-left: 1rem">
          <h4 class="card_title">${info[i].title}</h4>
          <p class="card_description" style="font-size:1rem;width:25rem">
            ${info[i].content}
          </p>
        </div>
        <div><img id="imagePreview${i + 1}" src="#" alt="Image Preview" style="margin-left: -30px"></div>
      </div>
      <div class="card_part">
        <p class="card_info">${info[i].time.slice(0, 10)} write · Selected for you</p>
        <i class="uil uil-bookmark" style="tex
        t-indent: 3.5rem;margin-top: .2rem;cursor:pointer" onclick="follow('${name}')"></i>
        <i class="uil uil-comment-alt-message" style="text-indent: 1rem;margin-top: .2rem;cursor: pointer " onclick="openForm()"></i>
      </div>
        <div style="display:flex">
        <img src=${localStorage.getItem('img')} alt="Avatar" style="width:40px;border-radius: 50%;height:40px;margin-left: 10px;margin-top: 5px"/>
        <div class="chat-popup" id="myForm">
          <textarea id="myTextarea${i}" placeholder="Type message.." name="msg" required style="border-color: #4b4b4b;text-indent: 2em;border-radius:25px;width:300px;white-space: pre-line;margin-top: 2px"></textarea>
          <i class="uil uil-navigator" style="width:3rem;height:3rem;position:relative; top:-18px;cursor:pointer" id="myButton" onclick="getMessage(${i},'${info[i].post_id}')"></i>
        </div>
        </div>

        <div class="chat-popup">Comments:</div>
        <div class="card_part">
        </div>
        </div>
        </div>
    `;
          card.appendChild(icon)
          card.appendChild(comments);
          cardContainer.appendChild(card);
        }
      },
      error: function (error) {
        // 请求失败后的处理逻辑
        console.log(error); // 可以在控制台打印错误信息
      }
    });
  });


  function openPage(pageName, elmnt, color) {
    // Hide all elements with class="tabcontent" by default */
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
      tabcontent[i].style.display = "none";
    }

    // Remove the background color of all tablinks/buttons
    tablinks = document.getElementsByClassName("tablink");
    for (i = 0; i < tablinks.length; i++) {
      tablinks[i].style.backgroundColor = "";
    }

    // Show the specific tab content
    document.getElementById(pageName).style.display = "block";

    // Add the specific color to the button used to open the tab content
    elmnt.style.backgroundColor = color;
  }

  // Get the element with id="defaultOpen" and click on it
  document.getElementById("defaultOpen").click();

  const cardContainer = document.getElementById('cardContainer');


</script>
</body>
</html>
